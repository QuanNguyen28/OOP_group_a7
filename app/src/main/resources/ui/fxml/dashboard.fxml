<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.chart.*?>

<!-- Modern tabbed dashboard: each task in its own Tab -->
<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="app.controller.DashboardController">

    <!-- Filters / global controls -->
    <top>
        <VBox spacing="8" styleClass="page">
            <HBox spacing="12">
                <Label text="Run:"/>
                <ComboBox fx:id="runSelector" prefWidth="220"/>

                <Separator orientation="VERTICAL"/>

                <Label text="From:"/>
                <DatePicker fx:id="fromDate"/>
                <Label text="To:"/>
                <DatePicker fx:id="toDate"/>

                <Separator orientation="VERTICAL"/>

                <Label text="Top N:"/>
                <Spinner fx:id="topNSpinner" prefWidth="90"/>

                <Button fx:id="btnRefresh" text="Refresh" styleClass="toolbar-btn"/>
                <Button fx:id="btnExport" text="Export CSV" styleClass="toolbar-btn"/>
            </HBox>

            <Label fx:id="statusLabel" text="Ready"/>
        </VBox>
    </top>

    <!-- Center content: 4 Tabs = 4 tasks -->
    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" styleClass="primary-tabs">
            <tabs>
                <!-- (1) Sentiment -->
                <Tab text="Sentiment">
                    <content>
                        <VBox spacing="8" styleClass="page">
                            <Label fx:id="overallSubtitle" text="Loading..."/>
                            <StackPane styleClass="card">
                                <LineChart fx:id="overallChart">
                                    <xAxis><CategoryAxis label="Day"/></xAxis>
                                    <yAxis><NumberAxis label="Posts"/></yAxis>
                                </LineChart>
                            </StackPane>
                        </VBox>
                    </content>
                </Tab>

                <!-- (2) Damage -->
                <Tab text="Damage">
                    <content>
                        <VBox spacing="8" styleClass="page">
                            <HBox spacing="8">
                                <Label text="View:"/>
                                <!-- ComboBox trống; items do Controller thêm -->
                                <ComboBox fx:id="damageView" prefWidth="180"/>
                            </HBox>
                            <StackPane styleClass="card">
                                <BarChart fx:id="damageChart">
                                    <xAxis><CategoryAxis label="Type/Day"/></xAxis>
                                    <yAxis><NumberAxis label="Count"/></yAxis>
                                </BarChart>
                            </StackPane>
                        </VBox>
                    </content>
                </Tab>

                <!-- (3) Relief -->
                <Tab text="Relief">
                    <content>
                        <StackPane styleClass="card">
                            <PieChart fx:id="reliefPie"/>
                        </StackPane>
                    </content>
                </Tab>

                <!-- ============== Task 3: Satisfaction by Category ============== -->
                <Tab text="Task 3: Satisfaction">
                <content>
                    <VBox spacing="10" alignment="CENTER" style="-fx-padding: 10;">
                        <Label text="Mức độ hài lòng theo từng loại hàng cứu trợ" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>

                        <!-- fx:id phải trùng với biến task3Chart trong Controller -->
                        <StackedBarChart fx:id="task3Chart">
                            <xAxis>
                                <CategoryAxis label="Loại hàng cứu trợ" />
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Số lượng bài viết" />
                            </yAxis>
                        </StackedBarChart>
                    </VBox>
                </content>
                </Tab>

                <!-- ============== Task 4: Sentiment over Time per Category ============== -->
                <Tab text="Task 4: Trends">
                <content>
                    <VBox spacing="10" alignment="CENTER" style="-fx-padding: 10;">
                        <Label text="Diễn biến tâm lý theo thời gian (Trung bình cộng)" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>

                        <!-- fx:id phải trùng với biến task4Chart trong Controller -->
                        <LineChart fx:id="task4Chart">
                            <xAxis>
                                <CategoryAxis label="Ngày" />
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Điểm cảm xúc (-1 đến 1)" lowerBound="-1" upperBound="1" autoRanging="false"/>
                            </yAxis>
                        </LineChart>
                    </VBox>
                </content>
                </Tab>
            </tabs>
        </TabPane>
    </center>
</BorderPane>