<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="app.controller.DashboardController">

    <!-- Modern Header with Gradient Background -->
    <top>
        <VBox spacing="16" style="-fx-background-color: linear-gradient(to right, derive(-color-primary-solid, 95%), derive(-color-accent, 95%)); -fx-padding: 24 32;">
            <!-- Title Section -->
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Button fx:id="backBtn" 
                        text="â† Quay Láº¡i" 
                        onAction="#onGoBack"
                        prefHeight="40"
                        prefWidth="140"
                        style="-fx-font-size: 14px; -fx-font-weight: 600; -fx-padding: 8 16; -fx-background-radius: 12; -fx-border-radius: 12; -fx-background-color: #f0f4ff; -fx-text-fill: #4f46e5; -fx-border-color: #c7d2fe; -fx-border-width: 1.5;"/>
                <Label text="ðŸ“Š" style="-fx-font-size: 28px;"/>
                <VBox>
                    <Label text="Báº£ng Äiá»u Khiá»ƒn PhÃ¢n TÃ­ch" styleClass="heading-2" style="-fx-text-fill: -color-primary-solid;"/>
                    <Label fx:id="statusLabel" text="âœ¨ Sáºµn sÃ ng" styleClass="subtitle"/>
                </VBox>
            </HBox>
            
            <!-- Controls Card -->
            <HBox spacing="16" alignment="CENTER_LEFT" styleClass="card" style="-fx-padding: 16 20;">
                <Button fx:id="btnExport" text="ðŸ“¥ Xuáº¥t CSV" styleClass="toolbar-btn" prefHeight="36"/>
                <Separator orientation="VERTICAL"/>
                
                <Label text="ðŸ“… Pháº¡m Vi Thá»i Gian:" style="-fx-font-weight: 600;"/>
                <DatePicker fx:id="dpFrom" promptText="Tá»« ngÃ y" prefHeight="36" prefWidth="150"/>
                <Label text="â†’" style="-fx-font-size: 16px;"/>
                <DatePicker fx:id="dpTo" promptText="Äáº¿n ngÃ y" prefHeight="36" prefWidth="150"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" styleClass="primary-tabs">
            <tabs>
                <!-- (1) Sentiment Analysis -->
                <Tab text="ðŸ˜Š  Cáº£m XÃºc">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background: -color-bg; -fx-background-color: -color-bg;">
                            <VBox spacing="20" styleClass="page" style="-fx-padding: 24;">
                                <!-- Subtitle -->
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="ðŸ“ˆ" style="-fx-font-size: 20px;"/>
                                    <Label fx:id="overallSubtitle" text="PhÃ¢n tÃ­ch xu hÆ°á»›ng cáº£m xÃºc..." styleClass="heading-3"/>
                                </HBox>
                                
                                <!-- Chart Card -->
                                <StackPane styleClass="card">
                                    <LineChart fx:id="overallChart">
                                        <xAxis><CategoryAxis label="NgÃ y" style="-fx-font-weight: 600;"/></xAxis>
                                        <yAxis><NumberAxis label="Sá»‘ BÃ i Viáº¿t" style="-fx-font-weight: 600;"/></yAxis>
                                    </LineChart>
                                </StackPane>

                                <!-- AI Analysis Section -->
                                <TitledPane text="ðŸ¤–  PhÃ¢n TÃ­ch Báº±ng AI (LLM)" expanded="false">
                                    <VBox spacing="12" style="-fx-padding: 16;">
                                        <HBox spacing="12" alignment="CENTER_LEFT">
                                            <Button fx:id="btnSummarizeOverall" 
                                                    text="âœ¨ Táº¡o BÃ¡o CÃ¡o Cáº£m XÃºc" 
                                                    styleClass="primary"
                                                    prefHeight="40"/>
                                            <Label text="Tá»± Ä‘á»™ng phÃ¢n tÃ­ch dá»±a trÃªn khoáº£ng thá»i gian Ä‘Ã£ chá»n" 
                                                   styleClass="caption"/>
                                        </HBox>
                                        <TextArea fx:id="txtOverallSummary" 
                                                  prefRowCount="8" 
                                                  wrapText="true"
                                                  promptText="BÃ¡o cÃ¡o AI sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y..."/>
                                    </VBox>
                                </TitledPane>
                            </VBox>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- (2) Damage Assessment -->
                <Tab text="âš ï¸  Thiá»‡t Háº¡i">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background: -color-bg; -fx-background-color: -color-bg;">
                            <VBox spacing="20" styleClass="page" style="-fx-padding: 24;">
                                <!-- Controls -->
                                
                                <!-- Chart Card -->
                                <StackPane styleClass="card">
                                    <BarChart fx:id="damageChart">
                                        <xAxis><CategoryAxis label="Loáº¡i Thiá»‡t Háº¡i / NgÃ y" style="-fx-font-weight: 600;"/></xAxis>
                                        <yAxis><NumberAxis label="Sá»‘ LÆ°á»£ng" style="-fx-font-weight: 600;"/></yAxis>
                                    </BarChart>
                                </StackPane>

                                <!-- AI Insights -->
                                <TitledPane text="ðŸ¤–  ÄÃ¡nh GiÃ¡ Báº±ng AI" expanded="false">
                                    <VBox spacing="12" style="-fx-padding: 16;">
                                        <Button fx:id="btnSummarizeDamage" 
                                                text="âœ¨ Táº¡o BÃ¡o CÃ¡o Thiá»‡t Háº¡i" 
                                                styleClass="primary"
                                                prefHeight="40"/>
                                        <TextArea fx:id="txtDamageSummary" 
                                                  prefRowCount="8" 
                                                  wrapText="true"
                                                  promptText="PhÃ¢n tÃ­ch chi tiáº¿t vá» thiá»‡t háº¡i..."/>
                                    </VBox>
                                </TitledPane>
                            </VBox>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- (3) Relief Distribution -->
                <Tab text="ðŸŽ  Cá»©u Trá»£">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background: -color-bg; -fx-background-color: -color-bg;">
                            <VBox spacing="20" styleClass="page" style="-fx-padding: 24;">
                                <!-- Header -->
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="ðŸ“¦" style="-fx-font-size: 20px;"/>
                                    <Label text="PhÃ¢n Bá»• HÃ ng Cá»©u Trá»£" styleClass="heading-3"/>
                                </HBox>
                                
                                <!-- Chart Card -->
                                <StackPane styleClass="card" style="-fx-padding: 32;">
                                    <PieChart fx:id="reliefPie"/>
                                </StackPane>

                                <!-- AI Analysis -->
                                <TitledPane text="ðŸ¤–  Insight tá»« AI" expanded="false">
                                    <VBox spacing="12" style="-fx-padding: 16;">
                                        <Button fx:id="btnSummarizeRelief" 
                                                text="âœ¨ PhÃ¢n TÃ­ch Xu HÆ°á»›ng Cá»©u Trá»£" 
                                                styleClass="primary"
                                                prefHeight="40"/>
                                        <TextArea fx:id="txtReliefSummary" 
                                                  prefRowCount="8" 
                                                  wrapText="true"
                                                  promptText="CÃ¡c insight vá» hÃ ng cá»©u trá»£..."/>
                                    </VBox>
                                </TitledPane>
                            </VBox>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Task 3 - Satisfaction -->
                <Tab text="ðŸ’¯  HÃ i LÃ²ng">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background: -color-bg; -fx-background-color: -color-bg;">
                            <VBox spacing="20" styleClass="page" style="-fx-padding: 24;">
                                <!-- Header -->
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="â­" style="-fx-font-size: 20px;"/>
                                    <Label text="Má»©c Äá»™ HÃ i LÃ²ng Theo Loáº¡i HÃ ng Cá»©u Trá»£" styleClass="heading-3"/>
                                </HBox>
                                
                                <!-- Chart Card -->
                                <StackPane styleClass="card">
                                    <StackedBarChart fx:id="task3Chart">
                                        <xAxis><CategoryAxis label="Loáº¡i HÃ ng Cá»©u Trá»£" style="-fx-font-weight: 600;"/></xAxis>
                                        <yAxis><NumberAxis label="Sá»‘ BÃ i Viáº¿t" style="-fx-font-weight: 600;"/></yAxis>
                                    </StackedBarChart>
                                </StackPane>

                                <!-- AI Summary -->
                                <TitledPane text="ðŸ¤–  PhÃ¢n TÃ­ch Má»©c Äá»™ HÃ i LÃ²ng" expanded="false">
                                    <VBox spacing="12" style="-fx-padding: 16;">
                                        <Button fx:id="btnSummarizeTask3" 
                                                text="âœ¨ Táº¡o BÃ¡o CÃ¡o HÃ i LÃ²ng" 
                                                styleClass="primary"
                                                prefHeight="40"/>
                                        <TextArea fx:id="txtTask3Summary" 
                                                  prefRowCount="8" 
                                                  wrapText="true"
                                                  promptText="ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ hÃ i lÃ²ng..."/>
                                    </VBox>
                                </TitledPane>
                            </VBox>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Task 4 - Trends -->
                <Tab text="ðŸ“ˆ  Xu HÆ°á»›ng">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background: -color-bg; -fx-background-color: -color-bg;">
                            <VBox spacing="20" styleClass="page" style="-fx-padding: 24;">
                                <!-- Header -->
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="ðŸ“‰" style="-fx-font-size: 20px;"/>
                                    <Label text="Diá»…n Biáº¿n TÃ¢m LÃ½ Theo Thá»i Gian" styleClass="heading-3"/>
                                </HBox>
                                
                                <!-- Chart Card -->
                                <StackPane styleClass="card">
                                    <LineChart fx:id="task4Chart">
                                        <xAxis><CategoryAxis label="NgÃ y" style="-fx-font-weight: 600;"/></xAxis>
                                        <yAxis><NumberAxis label="Äiá»ƒm Cáº£m XÃºc (-1 â†’ +1)" 
                                                          lowerBound="-1" 
                                                          upperBound="1" 
                                                          autoRanging="false"
                                                          style="-fx-font-weight: 600;"/></yAxis>
                                    </LineChart>
                                </StackPane>

                                <!-- AI Analysis -->
                                <TitledPane text="ðŸ¤–  PhÃ¢n TÃ­ch Xu HÆ°á»›ng" expanded="false">
                                    <VBox spacing="12" style="-fx-padding: 16;">
                                        <HBox spacing="12" alignment="CENTER_LEFT">
                                            <Button fx:id="btnSummarizeTask4" 
                                                    text="âœ¨ Táº¡o BÃ¡o CÃ¡o Xu HÆ°á»›ng" 
                                                    styleClass="primary"
                                                    prefHeight="40"/>
                                            <Label text="Sá»­ dá»¥ng khoáº£ng thá»i gian Ä‘Ã£ chá»n á»Ÿ header" 
                                                   styleClass="caption"/>
                                        </HBox>
                                        <TextArea fx:id="txtTask4Summary" 
                                                  prefRowCount="8" 
                                                  wrapText="true"
                                                  promptText="Insight vá» xu hÆ°á»›ng thay Ä‘á»•i..."/>
                                    </VBox>
                                </TitledPane>
                            </VBox>
                        </ScrollPane>
                    </content>
                </Tab>
            </tabs>
        </TabPane>
    </center>
</BorderPane>